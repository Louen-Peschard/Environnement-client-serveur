-- « Liste_des_plantes » contenant : Le nom de la plante, le nom de la zone où elle se trouve, son cycle végétatif actuel

CREATE VIEW liste_plantes AS
SELECT graine.nom as nom_plante, zone.nom as zone_nom, cycle_vegetatif.nom as cycle_nom
FROM graine INNER JOIN plante ON graine.id = plante.id_graine
INNER JOIN historique_cycle ON plante.id = historique_cycle.id_plante
INNER JOIN cycle_vegetatif ON historique_cycle.id_cycle = cycle_vegetatif.id
INNER JOIN changement_zone ON plante.id = changement_zone.id_plante
INNER JOIN zone ON changement_zone.id_zone = zone.id

--

/* « Plantes_hors_zone » : liste des plantes qui ne sont affectées à aucune zone :
- nom de la plante
- propriétaire s’il y en a un*/

CREATE VIEW plantes_hors_zone AS
Select graine.nom, utilisateur.pseudo
FROM graine 
INNER JOIN plante ON graine.id = plante.id_graine
LEFT JOIN changement_zone ON plante.id = changement_zone.id_zone
LEFT JOIN zone ON changement_zone.id_zone = zone.id
LEFT JOIN jardin ON zone.id_jardin = jardin.id
LEFT JOIN jardin_utilisateur ON jardin_utilisateur.id_jardin = jardin.id
LEFT JOIN utilisateur ON utilisateur.id = jardin_utilisateur.id_utilisateur
Where plante.id NOT IN (SELECT changement_zone.id_zone from changement_zone) 

--

/* « Zones_recap » Liste des zones
o Nom de la zone
o code rusticité
o nombre de plantes affectées à la zone */

CREATE VIEW Zones_recap AS
SELECT zone.nom, rusticite.code, COUNT(changement_zone.id_plante)
FROM graine
INNER JOIN plante ON graine.id = plante.id_graine
INNER JOIN changement_zone ON plante.id = changement_zone.id_plante
INNER JOIN zone ON zone.id = changement_zone.id_zone
INNER JOIN rusticite ON rusticite.id = zone.id_rusticite